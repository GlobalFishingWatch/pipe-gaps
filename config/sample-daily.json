{
    "pipe_type": "beam",
    "pipe_config": {
        "inputs": [
            {
                "kind": "query",
                "query_name": "messages",
                "query_params": {
                    "source_messages": "scratch_tomas_ttl30d.messages",
                    "source_segments": "pipe_ais_v3_published.segs_activity",
                    "start_date": "2024-01-01",
                    "end_date": "2024-01-02"
                },
                "mock_db_client": false
            }
        ],
        "side_inputs": [],
        "core": {
            "kind": "detect_gaps",
            "groups_key": "ssvid_day",
            "boundaries_key": "ssvid",
            "eval_last": true,
            "threshold": 6,
            "show_progress": false,
            "normalize_output": true,
            "filter_range": ["2024-01-01", "2024-01-02"]
        },
        "outputs": [
            {
                "kind": "json",
                "output_prefix": "gaps"
            },
            {
                "kind": "bigquery",
                "table": "scratch_tomas_ttl30d.pipe_ais_gaps_daily",
                "description": "Gaps for AIS position messages.",
                "schema": "gaps",
                "write_disposition": "WRITE_APPEND"
            }
        ],
        "options": {
            "runner": "direct"
        }
    }
}